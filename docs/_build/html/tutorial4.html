<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üî∑ STEP 3: Fit your transit time data to an ephemeris model. You can specify what type of model with the options ‚Äòlinear‚Äô or ‚Äòquadratic‚Äô. &mdash; Susie Sept. 2023 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=cc8b8c85"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="üî∑ STEP 2: Create the Ephemeris object and add your TransitTimes object." href="tutorial3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Susie
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="susie.html">User Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial1.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial2.html">Adding Transit Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial3.html">Creating Ephemeris Object</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fitting Transit Data</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Susie</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">üî∑ <strong>STEP 3:</strong> Fit your transit time data to an ephemeris model. You can specify what type of model with the options ‚Äòlinear‚Äô or ‚Äòquadratic‚Äô.</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial4.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="step-3-fit-your-transit-time-data-to-an-ephemeris-model-you-can-specify-what-type-of-model-with-the-options-linear-or-quadratic">
<h1>üî∑ <strong>STEP 3:</strong> Fit your transit time data to an ephemeris model. You can specify what type of model with the options ‚Äòlinear‚Äô or ‚Äòquadratic‚Äô.<a class="headerlink" href="#step-3-fit-your-transit-time-data-to-an-ephemeris-model-you-can-specify-what-type-of-model-with-the-options-linear-or-quadratic" title="Link to this heading">ÔÉÅ</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Getting a linear model will solve for period and conjuction time (and their respective errors)</span>
<span class="n">linear_model_data</span> <span class="o">=</span> <span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">get_model_ephemeris</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Getting a linear model will solve for period and conjuction time (and their respective errors)</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">linear_model_data</span> <span class="o">=</span> <span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">get_model_ephemeris</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;ephemeris_obj1&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Calling <code class="docutils literal notranslate"><span class="pre">get_model_ephemeris</span></code> will return a dictionary of data. You can view the data returned from this if you run <code class="docutils literal notranslate"><span class="pre">print(linear_model_data)</span></code>. Now you can use the linear_model_data dictionary for plotting methods, such as the ones below. You can use the same process for a quadratic model ephemeris (shown below).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linear_model_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;period&#39;: 1.0914196486248962,
 &#39;period_err&#39;: 3.187601645504582e-07,
 &#39;conjunction_time&#39;: 0.0030928415054687353,
 &#39;conjunction_time_err&#39;: 0.0007184099304791794,
 &#39;model_type&#39;: &#39;linear&#39;,
 &#39;model_data&#39;: array([3.09284151e-03, 3.20880470e+02, 3.25246148e+02, 6.25386552e+02,
        6.31935069e+02, 6.48306364e+02, 6.57037721e+02, 6.94145989e+02,
        6.95237409e+02, 7.14882963e+02, 7.38894195e+02, 9.79006518e+02,
        9.83372196e+02, 9.94286393e+02, 9.95377812e+02, 1.00301775e+03,
        1.02702898e+03, 1.02702898e+03, 1.05104021e+03, 1.07505145e+03,
        1.08269138e+03, 1.08487422e+03, 1.08596564e+03, 1.08814848e+03,
        1.10779404e+03, 1.36100339e+03, 1.37191759e+03, 1.37300901e+03,
        1.37519185e+03, 1.38828889e+03, 1.40466018e+03, 1.40793444e+03,
        1.43085425e+03, 1.43194567e+03, 1.43303709e+03, 1.43631135e+03,
        1.43740277e+03, 1.44395129e+03, 1.44504271e+03, 1.45486548e+03,
        1.45595690e+03, 1.46687110e+03, 1.46796252e+03, 1.46905394e+03,
        1.47014536e+03, 1.48105956e+03, 1.48979091e+03, 1.49088233e+03,
        1.72990324e+03, 1.73426891e+03, 1.75828015e+03, 1.76701150e+03,
        1.76919434e+03, 1.78229138e+03, 1.78665706e+03, 1.78993132e+03,
        1.80411977e+03, 1.81285113e+03, 1.81394255e+03, 2.08898030e+03,
        2.09007172e+03, 2.09116314e+03, 2.09225456e+03, 2.11408295e+03,
        2.11517437e+03, 2.13918560e+03, 2.14355128e+03, 2.14682554e+03,
        2.14791696e+03, 2.14900838e+03, 2.15883116e+03, 2.16210542e+03,
        2.17301961e+03, 2.17847671e+03, 2.18829949e+03, 2.19593943e+03,
        2.20357936e+03, 2.20576220e+03, 2.20685362e+03, 2.47097718e+03,
        2.49498841e+03, 2.49717125e+03, 2.52991384e+03, 2.53100526e+03,
        2.54410229e+03, 2.54519371e+03, 2.55174223e+03, 2.55283365e+03,
        2.58775908e+03, 2.83005424e+03, 2.87480245e+03, 2.87589387e+03,
        2.91081930e+03, 2.91191072e+03, 2.93592195e+03, 3.15638872e+03,
        3.17603427e+03, 3.18803989e+03, 3.19131415e+03, 3.21095970e+03,
        3.21205112e+03, 3.25025081e+03, 3.25134223e+03, 3.25679932e+03,
        3.25789074e+03, 3.26116500e+03, 3.26553068e+03, 3.26553068e+03,
        3.27098778e+03, 3.27317062e+03, 3.28517624e+03, 3.29281617e+03,
        3.29390759e+03, 3.29499901e+03, 3.51110010e+03, 3.53511133e+03,
        3.54493411e+03, 3.55803115e+03, 3.55912257e+03, 3.56239683e+03,
        3.60823645e+03, 3.60932787e+03, 3.61696781e+03, 3.61915065e+03,
        3.62133349e+03, 3.63988762e+03, 3.63988762e+03, 3.64097904e+03,
        3.64425330e+03, 3.64643614e+03, 3.64643614e+03, 3.64752756e+03,
        3.64752756e+03, 3.65080182e+03, 3.66280743e+03, 3.89637124e+03,
        3.95639932e+03, 3.97931913e+03, 3.99132475e+03])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we can plot this model</span>
<span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">plot_model_ephemeris</span><span class="p">(</span><span class="n">linear_model_data</span><span class="p">,</span> <span class="n">save_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d408c1e00ddfa7020599f7ed283595c3de60354882ead1e7e58f4e05e0bd934f.png" src="_images/d408c1e00ddfa7020599f7ed283595c3de60354882ead1e7e58f4e05e0bd934f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Getting a quadratic model will solve for period, conjuction time, and period change per epoch (and their respective errors)</span>
<span class="n">quadratic_model_data</span> <span class="o">=</span> <span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">get_model_ephemeris</span><span class="p">(</span><span class="s1">&#39;quadratic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quadratic_model_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;conjunction_time&#39;: 0.0016704341826483176,
 &#39;conjunction_time_err&#39;: 0.0014642050906115362,
 &#39;period&#39;: 1.0914213749985644,
 &#39;period_err&#39;: 1.5818372240135891e-06,
 &#39;period_change_by_epoch&#39;: -8.367463423862439e-10,
 &#39;period_change_by_epoch_err&#39;: 7.510573769001014e-10,
 &#39;model_type&#39;: &#39;quadratic&#39;,
 &#39;model_data&#39;: array([1.67043418e-03, 3.20879519e+02, 3.25245203e+02, 6.25385981e+02,
        6.31934506e+02, 6.48305820e+02, 6.57037187e+02, 6.94145496e+02,
        6.95236917e+02, 7.14882492e+02, 7.38893750e+02, 9.79006307e+02,
        9.83371990e+02, 9.94286196e+02, 9.95377616e+02, 1.00301756e+03,
        1.02702881e+03, 1.02702881e+03, 1.05104007e+03, 1.07505132e+03,
        1.08269126e+03, 1.08487410e+03, 1.08596552e+03, 1.08814837e+03,
        1.10779394e+03, 1.36100347e+03, 1.37191768e+03, 1.37300910e+03,
        1.37519194e+03, 1.38828898e+03, 1.40466029e+03, 1.40793455e+03,
        1.43085437e+03, 1.43194579e+03, 1.43303721e+03, 1.43631148e+03,
        1.43740290e+03, 1.44395142e+03, 1.44504284e+03, 1.45486562e+03,
        1.45595704e+03, 1.46687124e+03, 1.46796266e+03, 1.46905408e+03,
        1.47014550e+03, 1.48105971e+03, 1.48979107e+03, 1.49088249e+03,
        1.72990350e+03, 1.73426918e+03, 1.75828042e+03, 1.76701178e+03,
        1.76919462e+03, 1.78229166e+03, 1.78665734e+03, 1.78993160e+03,
        1.80412006e+03, 1.81285142e+03, 1.81394284e+03, 2.08898065e+03,
        2.09007207e+03, 2.09116349e+03, 2.09225491e+03, 2.11408330e+03,
        2.11517472e+03, 2.13918596e+03, 2.14355164e+03, 2.14682590e+03,
        2.14791732e+03, 2.14900874e+03, 2.15883151e+03, 2.16210577e+03,
        2.17301997e+03, 2.17847707e+03, 2.18829985e+03, 2.19593978e+03,
        2.20357972e+03, 2.20576256e+03, 2.20685398e+03, 2.47097752e+03,
        2.49498875e+03, 2.49717159e+03, 2.52991417e+03, 2.53100559e+03,
        2.54410262e+03, 2.54519404e+03, 2.55174256e+03, 2.55283398e+03,
        2.58775940e+03, 2.83005448e+03, 2.87480267e+03, 2.87589409e+03,
        2.91081950e+03, 2.91191092e+03, 2.93592214e+03, 3.15638879e+03,
        3.17603433e+03, 3.18803994e+03, 3.19131419e+03, 3.21095973e+03,
        3.21205115e+03, 3.25025081e+03, 3.25134223e+03, 3.25679933e+03,
        3.25789075e+03, 3.26116500e+03, 3.26553068e+03, 3.26553068e+03,
        3.27098777e+03, 3.27317061e+03, 3.28517622e+03, 3.29281615e+03,
        3.29390757e+03, 3.29499899e+03, 3.51109990e+03, 3.53511111e+03,
        3.54493388e+03, 3.55803091e+03, 3.55912233e+03, 3.56239658e+03,
        3.60823616e+03, 3.60932758e+03, 3.61696751e+03, 3.61915035e+03,
        3.62133319e+03, 3.63988730e+03, 3.63988730e+03, 3.64097872e+03,
        3.64425298e+03, 3.64643581e+03, 3.64643581e+03, 3.64752723e+03,
        3.64752723e+03, 3.65080149e+03, 3.66280709e+03, 3.89637065e+03,
        3.95639866e+03, 3.97931844e+03, 3.99132404e+03])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">plot_model_ephemeris</span><span class="p">(</span><span class="n">quadratic_model_data</span><span class="p">,</span> <span class="n">save_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/36389867eed56bc0a50001f3e2f75f64b5fd23401985328a1d51e3e30eaaeb3d.png" src="_images/36389867eed56bc0a50001f3e2f75f64b5fd23401985328a1d51e3e30eaaeb3d.png" />
</div>
</div>
<p>We can also plot the model uncertainties with the <code class="docutils literal notranslate"><span class="pre">plot_timing_uncertainties</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">plot_timing_uncertainties</span><span class="p">(</span><span class="n">linear_model_data</span><span class="p">,</span> <span class="n">save_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c9ae10b64ba510615b3068832a28184d5205bfbffaa2fbe2cbf5ac1001e942e8.png" src="_images/c9ae10b64ba510615b3068832a28184d5205bfbffaa2fbe2cbf5ac1001e942e8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">plot_timing_uncertainties</span><span class="p">(</span><span class="n">quadratic_model_data</span><span class="p">,</span> <span class="n">save_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0873f357374c7926195d6e5fb39700ea309b2a0355b887468391be9f52322c02.png" src="_images/0873f357374c7926195d6e5fb39700ea309b2a0355b887468391be9f52322c02.png" />
</div>
</div>
<p>We can get the BIC value for a specific model fit using the model data dictionaries returned from the <code class="docutils literal notranslate"><span class="pre">get_model_ephemeris</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linear_bic_value</span> <span class="o">=</span> <span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">calc_bic</span><span class="p">(</span><span class="n">linear_model_data</span><span class="p">)</span>
<span class="n">quadratic_bic_value</span> <span class="o">=</span> <span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">calc_bic</span><span class="p">(</span><span class="n">quadratic_model_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Linear Model BIC: </span><span class="si">{</span><span class="n">linear_bic_value</span><span class="si">}</span><span class="se">\n</span><span class="s2">Quadratic Model BIC: </span><span class="si">{</span><span class="n">quadratic_bic_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Model BIC: 30.715948366661767
Quadratic Model BIC: 34.417185157879864
</pre></div>
</div>
</div>
</div>
<p>And we can also get a delta BIC value. We do not need to input any data for this method. It will create the linear and quadratic models for you and calculate the BIC and delta BIC values. However, it <strong>ONLY returns the delta BIC value</strong> and not the other data calculated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_bic_value</span> <span class="o">=</span> <span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">calc_delta_bic</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Delta BIC: </span><span class="si">{</span><span class="n">delta_bic_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delta BIC: 116.99471456396566
</pre></div>
</div>
</div>
</div>
<p>The last two methods accessible to the user are an OC plotting method and a running delta BIC plotting method.</p>
<p>The OC plot for now just plots the observed minus calculated points (calculated with $x=E$, $y=T_0-PE$, $y_{\rm err}=\sigma T_0$ and a curve with the quadratic term ($x=E$, $y=0.5 \frac{dP}{dE} (E - {\rm median} (E))^2$).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">plot_oc_plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ac91508c3601967ec7dea262d07123cffc8b491ad2ecf798b83639c48ab34335.png" src="_images/ac91508c3601967ec7dea262d07123cffc8b491ad2ecf798b83639c48ab34335.png" />
</div>
</div>
<p>This is the <code class="docutils literal notranslate"><span class="pre">plot_running_delta_bic</span></code> method. This is a work in progress, but the basic data is in there.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ephemeris_obj1</span><span class="o">.</span><span class="n">plot_running_delta_bic</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial3.html" class="btn btn-neutral float-left" title="üî∑ STEP 2: Create the Ephemeris object and add your TransitTimes object." accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Holly VanLooy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>