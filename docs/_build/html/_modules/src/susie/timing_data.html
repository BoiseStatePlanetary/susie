<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>src.susie.timing_data - Susie Sept. 2023 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Susie Sept. 2023 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Susie Sept. 2023 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../susie.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ.html">Frequently Asked Questions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../basic_usage.html">Basic Usage of TimingData and Ephemeris Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../special_usage.html">Special TimingData Object Usage</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for src.susie.timing_data</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">coordinates</span> <span class="k">as</span> <span class="n">coord</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="c1"># logging.basicConfig(format=&#39;%(levelname)s: %(message)s&#39;, datefmt=&#39;%m/%d/%Y %I:%M:%S %p&#39;)</span>
<span class="c1"># logger = getLogger(__name__)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;lumberjack&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="TimingData">
<a class="viewcode-back" href="../../../susie.html#src.susie.timing_data.TimingData">[docs]</a>
<span class="k">class</span> <span class="nc">TimingData</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents timing mid point data over observations. Holds data to be accessed by Ephemeris class.</span>

<span class="sd">    The TimingData object processes, formats, and holds user data to be passed to the ephemeris object.</span>
<span class="sd">    </span>
<span class="sd">    Timing conversions are applied to ensure that all data is processed correctly and users are aware of </span>
<span class="sd">    timing formats and scales, which can give rise to false calculations in our metrics. If data is not specified</span>
<span class="sd">    to be in Barycentric Julian Date format with the TDB time scale, timing data will be corrected for barycentric</span>
<span class="sd">    light travel time using the Astropy Time utilities. </span>
<span class="sd">    </span>
<span class="sd">    If mid time uncertainties are not provided, we will generate placeholder values of 1.</span>

<span class="sd">    Our implementations rely on Numpy functions. This object implements checks to ensure that data are stored in </span>
<span class="sd">    Numpy arrays and are of correct data types. The appropriate Type or Value Error is raised if there are any issues.</span>
<span class="sd">    </span>
<span class="sd">    If timing data contains both transit mid times and occultation mid times, users can pass in an array of &#39;tra&#39; </span>
<span class="sd">    and &#39;occ&#39; strings that correspond to the epochs, mid time, and uncertainty timing data. If passed in, timing data</span>
<span class="sd">    will be separated according to the order of the tra_or_occ array and stored in their corresponding objects.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ------------</span>
<span class="sd">        time_format: str </span>
<span class="sd">            An abbreviation of the data&#39;s time system. Abbreviations for systems can be found on [Astropy&#39;s Time documentation](https://docs.astropy.org/en/stable/time/#id3).</span>
<span class="sd">        epochs: numpy.ndarray[int]</span>
<span class="sd">            List of orbit number reference points for timing observations</span>
<span class="sd">        mid_times: numpy.ndarray[float]</span>
<span class="sd">            List of observed timing mid points corresponding with epochs, in timing units given by time_format</span>
<span class="sd">        mid_time_uncertainties: Optional(numpy.ndarray[float])</span>
<span class="sd">            List of uncertainties corresponding to timing mid points, in timing units given by time_format. If given None, will be replaced with array of 1&#39;s with same shape as `mid_times`.</span>
<span class="sd">        time_scale: Optional(str)</span>
<span class="sd">            An abbreviation of the data&#39;s time scale. Abbreviations for scales can be found on [Astropy&#39;s Time documentation](https://docs.astropy.org/en/stable/time/#id6).</span>
<span class="sd">        object_ra: Optional(float)</span>
<span class="sd">            The right ascension of observed object represented by data, in degrees</span>
<span class="sd">        object_dec: Optional(float)</span>
<span class="sd">            The declination of observed object represented by data, in degrees</span>
<span class="sd">        observatory_lon: Optional(float)</span>
<span class="sd">            The longitude of observatory data was collected from, in degrees</span>
<span class="sd">        observatory_lat: Optional(float) </span>
<span class="sd">            The latitude of observatory data was collected from, in degrees</span>
<span class="sd">    </span>
<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">        Error raised if  </span>
<span class="sd">            * parameters are not NumPy Arrays</span>
<span class="sd">            * timing data arrays are not the same shape</span>
<span class="sd">            * the values of epochs are not all ints</span>
<span class="sd">            * the values of mid_times and uncertainites are not all floats</span>
<span class="sd">            * values of uncertainities are not all positive</span>
<span class="sd">            * values of transit or occultation array or not all &#39;tra&#39; or &#39;occ&#39;</span>

<span class="sd">    Side Effects</span>
<span class="sd">    -------------</span>
<span class="sd">        Variables epochs and mid_times are shifted to start at zero by subtracting the minimum number from each value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_format</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">mid_times</span><span class="p">,</span> <span class="n">mid_time_uncertainties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tra_or_occ</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">object_ra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">object_dec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">observatory_lon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">observatory_lat</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Configure logging to remove &#39;root&#39; prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_configure_logging</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="n">epochs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_times</span> <span class="o">=</span> <span class="n">mid_times</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span> <span class="o">=</span> <span class="n">tra_or_occ</span>
        <span class="k">if</span> <span class="n">mid_time_uncertainties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># If no uncertainties provided, make an array of 1s in the same shape of epochs</span>
            <span class="n">mid_time_uncertainties</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span> <span class="o">=</span> <span class="n">mid_time_uncertainties</span>
        <span class="c1"># Check that timing system and scale are JD and TDB</span>
        <span class="k">if</span> <span class="n">time_format</span> <span class="o">!=</span> <span class="s1">&#39;jd&#39;</span> <span class="ow">or</span> <span class="n">time_scale</span> <span class="o">!=</span> <span class="s1">&#39;tdb&#39;</span><span class="p">:</span>
            <span class="c1"># If not correct time format and scale, create time objects and run corrections</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recieved time format </span><span class="si">{</span><span class="n">time_format</span><span class="si">}</span><span class="s2"> and time scale </span><span class="si">{</span><span class="n">time_scale</span><span class="si">}</span><span class="s2">. Correcting all times to BJD timing system with TDB time scale. If no time scale is given, default is automatically assigned to UTC. If this is incorrect, please set the time format and time scale for TransitTime object.&quot;</span><span class="p">)</span>
            <span class="c1"># Set timing data to None for now</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mid_times</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">mid_times_obj</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="n">mid_times</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">time_format</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">time_scale</span><span class="p">)</span>
            <span class="n">mid_time_uncertainties_obj</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="n">mid_time_uncertainties</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">time_format</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">time_scale</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_times</span><span class="p">(</span><span class="n">mid_times_obj</span><span class="p">,</span> <span class="n">mid_time_uncertainties_obj</span><span class="p">,</span> <span class="p">(</span><span class="n">object_ra</span><span class="p">,</span> <span class="n">object_dec</span><span class="p">),</span> <span class="p">(</span><span class="n">observatory_lon</span><span class="p">,</span> <span class="n">observatory_lat</span><span class="p">))</span>
        <span class="c1"># Call validation function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_configure_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_barycentric_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_obj</span><span class="p">,</span> <span class="n">obj_location</span><span class="p">,</span> <span class="n">obs_location</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to correct non-barycentric time formats to Barycentric Julian Date in TDB time scale.</span>

<span class="sd">        This function will run under the given circumstances:</span>
<span class="sd">            * If the timing format provided is not JD (time_format == &#39;jd&#39;)</span>
<span class="sd">            * If the timing scale is not provided</span>
<span class="sd">            * If the timing scale provided is not TDB (time_sclae == &#39;tdb&#39;)</span>

<span class="sd">        Calculates the light travel time for the given Astropy timing object and adds the light </span>
<span class="sd">        travel time to each original value in the given timing data. If the given Astropy timing object time data </span>
<span class="sd">        contains a list of 1s, which means this is placeholder timing uncertainty data, no timing correction will </span>
<span class="sd">        be applied as this is not real data. If the timing correction proceeds, the `light_travel_time` function </span>
<span class="sd">        from Astropy will be applied and added to the original timing data. Timing data corrected for Barycentric  </span>
<span class="sd">        light travel time will be returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            time_obj : numpy.ndarray[float]</span>
<span class="sd">               List of timing data to be corrected to the Barycentric Julian Date time format in the TDB time scale.</span>
<span class="sd">            obj_location : Astropy.coordinates.SkyCoord obj</span>
<span class="sd">                The RA and DEC in degrees of the object being observed, stored as an Astropy coordinates.SkyCoord object.</span>
<span class="sd">            obs_location : Astropy.coordinates.EarthLocation obj</span>
<span class="sd">                The longitude and latitude in degrees of the site of observation, stored as an Astropy coordinates.EarthLocation object. </span>
<span class="sd">                If None given, uses gravitational center of Earth at North Pole.</span>
<span class="sd">       </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            time_obj.value : numpy.ndarray[float]</span>
<span class="sd">                Returned only if these are placeholder uncertainties and no correction is needed.</span>
<span class="sd">            corrected_time_vals : numpy.ndarray[float]</span>
<span class="sd">                List of mid times corrected to Barycentric Julian Date time format with TDB time scale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If given uncertainties, check they are actual values and not placeholders vals of 1</span>
        <span class="c1"># If they are placeholder vals, no correction needed, just return array of 1s</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">time_obj</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">time_obj</span><span class="o">.</span><span class="n">value</span>
        <span class="n">time_obj</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">obs_location</span>
        <span class="n">ltt_bary</span> <span class="o">=</span> <span class="n">time_obj</span><span class="o">.</span><span class="n">light_travel_time</span><span class="p">(</span><span class="n">obj_location</span><span class="p">)</span>
        <span class="n">corrected_time_vals</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_obj</span><span class="o">.</span><span class="n">tdb</span><span class="o">+</span><span class="n">ltt_bary</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">corrected_time_vals</span>
    
    <span class="k">def</span> <span class="nf">_validate_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mid_times_obj</span><span class="p">,</span> <span class="n">mid_time_uncertainties_obj</span><span class="p">,</span> <span class="n">obj_coords</span><span class="p">,</span> <span class="n">obs_coords</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates object and observatory information and populates Astropy objects for barycentric light travel time correction.</span>

<span class="sd">        Checks that object coordinates (right ascension and declination) and are of correct types. If correct object </span>
<span class="sd">        coordinates are given, will create an Astropy SkyCoord object. Checks that observatory coordinates (longitude </span>
<span class="sd">        and latitude) are given and of correct types. If given, will populate an Astropy EarthLocation object. If not</span>
<span class="sd">        given, will populate Astropy EarthLocation with gravitational center of Earth at North Pole. Passes the validated</span>
<span class="sd">        SkyCoord, EarthLocation, and Time objects to the `_calc_barycentric_time` correction function to convert times</span>
<span class="sd">        to BJD TDB timing format and scale.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            mid_times_obj : (astropy.time.Time[numpy.ndarray[floats], string, string])</span>
<span class="sd">                An Astropy Time object containing the mid time data, time format, and time scale</span>
<span class="sd">            mid_time_uncertainties_obj : Optional(astropy.time.Time[numpy.ndarray[floats], string, string])</span>
<span class="sd">                An Astropy Time object containing timing uncertainty data, time format, and time scale. If no uncertainties intially given, data has been replaced with array of 1&#39;s with same shape as `mid_times`.</span>
<span class="sd">            obj_coords : object_ra: float, object_dec: float)</span>
<span class="sd">                Tuple of the right ascension and declination in degrees of the object being observed.</span>
<span class="sd">            obs_coords : Optional((observatory_lon: float, observatory_lat: float))    </span>
<span class="sd">                Tuple of the longitude and latitude in degrees of the site of observation.</span>

<span class="sd">        Raises</span>
<span class="sd">            ValueError :</span>
<span class="sd">                Error if None recieved for object_ra or object_dec.</span>
<span class="sd">            Warning:</span>
<span class="sd">                Warning if no observatory coordinates are given.</span>
<span class="sd">                Warning notifying user that barycentric light travel time correction is taking place with the given</span>
<span class="sd">                information.</span>
<span class="sd">        ------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if there are objects coords, raise error if not</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">elem</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">obj_coords</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Recieved None for object right ascension and/or declination. Please enter ICRS coordinate values in degrees for object_ra and object_dec for TransitTime object.&quot;</span><span class="p">)</span>
        <span class="c1"># Check if there are observatory coords, raise warning and use earth grav center coords if not</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">elem</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">obs_coords</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to process observatory coordinates </span><span class="si">{</span><span class="n">obs_coords</span><span class="si">}</span><span class="s2">. &quot;</span>
                             <span class="s2">&quot;Using gravitational center of Earth.&quot;</span><span class="p">)</span>
            <span class="n">obs_location</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">EarthLocation</span><span class="o">.</span><span class="n">from_geocentric</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obs_location</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">EarthLocation</span><span class="o">.</span><span class="n">from_geodetic</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">obs_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">obj_location</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">obj_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">obj_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using ICRS coordinates in degrees of RA and Dec </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">obj_location</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="nb">round</span><span class="p">(</span><span class="n">obj_location</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> for time correction. Using geodetic Earth coordinates in degrees of longitude and latitude </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">obs_location</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="nb">round</span><span class="p">(</span><span class="n">obs_location</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> for time correction.&quot;</span><span class="p">)</span>
        <span class="c1"># Perform correction, will return array of corrected times</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_barycentric_time</span><span class="p">(</span><span class="n">mid_time_uncertainties_obj</span><span class="p">,</span> <span class="n">obj_location</span><span class="p">,</span> <span class="n">obs_location</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_barycentric_time</span><span class="p">(</span><span class="n">mid_times_obj</span><span class="p">,</span> <span class="n">obj_location</span><span class="p">,</span> <span class="n">obs_location</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_tra_or_occ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;TODO: Docstring</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check that object is of type array</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The variable &#39;tra_or_occ&#39; expected a NumPy array (np.ndarray) but received a different data type&quot;</span><span class="p">)</span>
        <span class="c1"># Check if any values are not valid in tra_or_occ array</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;tra&#39;</span><span class="p">,</span> <span class="s1">&#39;occ&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;tra_or_occ array cannot contain string values other than &#39;tra&#39; or &#39;occ&#39;&quot;</span><span class="p">)</span>
        <span class="c1"># Check the shape </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_times</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shapes of &#39;tra_or_occ&#39;, &#39;mid_time_uncertainties&#39;, &#39;mid_times&#39;, and &#39;epochs&#39; arrays do not match.&quot;</span><span class="p">)</span>
        <span class="c1"># strings</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All values in &#39;tra_or_occ&#39; must be of type string.&quot;</span><span class="p">)</span>
        <span class="c1"># null values</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;tra_or_occ&#39; array contains NaN (Not-a-Number) values.&quot;</span><span class="p">)</span>
   
    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks that all object attributes are of correct types and within value constraints.</span>

<span class="sd">        Validates the types of the main data attributes: epochs, mid_times, and mid_time_uncertainties. </span>
<span class="sd">        The following checks are in place:</span>
<span class="sd">            * Contained in numpy arrays</span>
<span class="sd">            * Epochs are integers</span>
<span class="sd">            * Mid times and uncertainties are floats</span>
<span class="sd">            * No null or nan values are in the data</span>
<span class="sd">            * Epochs, mid times, and uncertainties all contain the same amount of data points</span>
<span class="sd">            * All uncertainties are positive</span>
<span class="sd">        If the epochs and mid times do not start at zero, the arrays will be shifted to start at zero by </span>
<span class="sd">        subtracting the minimum value of the array from each data point in the array.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">            TypeError :</span>
<span class="sd">                Error if &#39;epochs&#39;, &#39;mid_traisit_times&#39;, or &#39;mid_time_uncertainties&#39; are not NumPy arrays.</span>
<span class="sd">            ValueError :</span>
<span class="sd">                Error if shapes of &#39;epochs&#39;, &#39;mid_times&#39;, and &#39;mid_time_uncertainties&#39; arrays do not match.</span>
<span class="sd">            TypeError :</span>
<span class="sd">                Error if values in &#39;epochs&#39; are not ints, values in &#39;mid_times&#39; or &#39;mid_time_uncertainties&quot; are not floats. </span>
<span class="sd">            ValueError :</span>
<span class="sd">                Error if &#39;epochs&#39;, &#39;mid_times&#39;, or &#39;mid_time_uncertainties&#39; contain a NaN (Not-a-Number) value.</span>
<span class="sd">            ValueError :</span>
<span class="sd">                Error if &#39;mid_time_uncertainties&#39; contains a negative or zero value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check that all are of type array</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The variable &#39;epochs&#39; expected a NumPy array (np.ndarray) but received a different data type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid_times</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The variable &#39;mid_times&#39; expected a NumPy array (np.ndarray) but received a different data type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The variable &#39;mid_time_uncertainties&#39; expected a NumPy array (np.ndarray) but received a different data type&quot;</span><span class="p">)</span>
        <span class="c1"># Check that all are same shape</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_times</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shapes of &#39;epochs&#39;, &#39;mid_times&#39;, and &#39;mid_time_uncertainties&#39; arrays do not match.&quot;</span><span class="p">)</span>
        <span class="c1"># Check that all values in arrays are correct</span>
        <span class="c1"># if not all(isinstance(value, (int, np.int64)) for value in self.epochs) or not all(isinstance(value, (int, np.int32)) for value in self.epochs):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">))</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All values in &#39;epochs&#39; must be of type int, numpy.int64, or numpy.int32.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_times</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All values in &#39;mid_times&#39; must be of type float.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All values in &#39;mid_time_uncertainties&#39; must be of type float.&quot;</span><span class="p">)</span>
        <span class="c1"># Check that there are no null values</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;epochs&#39; array contains NaN (Not-a-Number) values.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid_times</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;mid_times&#39; array contains NaN (Not-a-Number) values.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;mid_time_uncertainties&#39; array contains NaN (Not-a-Number) values.&quot;</span><span class="p">)</span>
        <span class="c1"># Check that mid_time_uncertainties are positive and non-zero (greater than zero)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid_time_uncertainties</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;mid_time_uncertainties&#39; array must contain non-negative and non-zero values.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Shift epochs and mid transit times</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">)</span>
            <span class="c1"># TODO import warning that we are minimizing their epochs and transit times</span>
        <span class="c1"># if self.mid_times[0] != 0:</span>
        <span class="c1">#     self.mid_times -= np.min(self.mid_times)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Create list of just &#39;tra&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;tra&#39;</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tra_or_occ</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_tra_or_occ</span><span class="p">()</span></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Boise State University
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=cc8b8c85"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=4e2eecee"></script>
    </body>
</html>