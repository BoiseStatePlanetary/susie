<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>susie.ephemeris &mdash; Susie Sept. 2023 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=cc8b8c85"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Susie
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../susie.html">Susie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Susie</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">susie.ephemeris</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for susie.ephemeris</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># from transit_times import TransitTimes</span>
<span class="kn">from</span> <span class="nn">susie.transit_times</span> <span class="kn">import</span> <span class="n">TransitTimes</span>

<div class="viewcode-block" id="BaseModelEphemeris">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.BaseModelEphemeris">[docs]</a>
<span class="k">class</span> <span class="nc">BaseModelEphemeris</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Creates a holding place for the fit variables (x, y, yerr, \*\*kwargs) before a linear, quadratic, or custom fit can be created. </span>
<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="BaseModelEphemeris.fit_model">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.BaseModelEphemeris.fit_model">[docs]</a>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span></div>
</div>



<div class="viewcode-block" id="LinearModelEphemeris">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.LinearModelEphemeris">[docs]</a>
<span class="k">class</span> <span class="nc">LinearModelEphemeris</span><span class="p">(</span><span class="n">BaseModelEphemeris</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Generates a linear fit to the model ephemeris data. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        BaseModelEphemeris : class</span>
<span class="sd">            a holding place for x, y, and yerr</span>

<span class="sd">    STEP 1: create a linear fit model by calling lin_fit.</span>
<span class="sd">    </span>
<span class="sd">    STEP 2: fit the model ephemieris data to the linear fit using SciPy curve fit techniques by calling fit_model.</span>

<span class="sd">    Returns</span>
<span class="sd">    ------- </span>
<span class="sd">        Return data : dictionary</span>
<span class="sd">            contains the period and conjunction time values and errors, which is used to build a best fit linear regression for the model ephemeris data.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="LinearModelEphemeris.lin_fit">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.LinearModelEphemeris.lin_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">lin_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">T0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        creates an initial linear fit model based off of the first data point in (FILE RETURNED BY TRANSIT_TIMES.PY)</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            x : ??</span>
<span class="sd">                The mid-transit time</span>
<span class="sd">            P : ??</span>
<span class="sd">                The period of a transit ?? </span>
<span class="sd">            T0 : ??</span>
<span class="sd">                the initial epoch associated with a mid-transit time</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            P*x + T0 :</span>
<span class="sd">                a linear function based off of the inital data points in (FILE RETURNED BY TRANSIT_TIMES.PY)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">P</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">T0</span></div>

    
<div class="viewcode-block" id="LinearModelEphemeris.fit_model">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.LinearModelEphemeris.fit_model">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compares the model ephemieris data to the linear fit created by the inital data. Then creates a curve fit which minimizes the difference between the two data sets. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            x : list</span>
<span class="sd">                The list of epochs, normalized to start at 0 (Question for Malia: has this been normalized to 0 yet? - I&#39;m 99% sure the answer is yes)</span>
<span class="sd">            y : ??</span>
<span class="sd">                The mid-transit times of a given epoch</span>
<span class="sd">            yerr : ??</span>
<span class="sd">                The error in the mid-transit time  </span>
<span class="sd">            **kwargs : ??</span>
<span class="sd">                define this</span>

<span class="sd">        Returns</span>
<span class="sd">        ------- </span>
<span class="sd">        Return data : dictionary</span>
<span class="sd">            contains the period and conjunction time values and errors, which is used to build a best fit linear regression for the model ephemeris data. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lin_fit</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">unc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>
        <span class="n">return_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;period_err&#39;</span><span class="p">:</span> <span class="n">unc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;conjunction_time&#39;</span><span class="p">:</span> <span class="n">popt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;conjunction_time_err&#39;</span><span class="p">:</span> <span class="n">unc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="k">return</span><span class="p">(</span><span class="n">return_data</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="QuadraticModelEphemeris">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.QuadraticModelEphemeris">[docs]</a>
<span class="k">class</span> <span class="nc">QuadraticModelEphemeris</span><span class="p">(</span><span class="n">BaseModelEphemeris</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Generates a quadratic fit to the model ephemeris data. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ---------- </span>
<span class="sd">        BaseModelEphemeris : class</span>
<span class="sd">            a holding place for x, y, and yerr</span>

<span class="sd">    STEP 1: create a quadratic fit model.</span>
<span class="sd">    </span>
<span class="sd">    STEP 2: fit the model ephemieris data to the quadratic fit using SciPy curve fit techniques.</span>

<span class="sd">    Returns</span>
<span class="sd">    ------- </span>
<span class="sd">        Return data : dictionary</span>
<span class="sd">            contains the period, conjunction time, and the period change by epoch values and errors, which is used to build a best fit quadratic regression for the model ephemeris data.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="QuadraticModelEphemeris.quad_fit">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.QuadraticModelEphemeris.quad_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">quad_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dPdE</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">T0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        creates an initial quadratic fit model based off of the first data point in ??? - I think I need to review the paper - do this week of 10/30</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            x : ??</span>
<span class="sd">                The mid-transit time</span>
<span class="sd">            dPdE : ??</span>
<span class="sd">                change in period with respect to Epoch (double check this)</span>
<span class="sd">            p : ??</span>
<span class="sd">                The period of the transit time, in days??</span>
<span class="sd">            T0 : ??</span>
<span class="sd">                The initial epoch associated with a mid-transit time</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            0.5*dPdE*x*x + P*x + T0 : ??</span>
<span class="sd">                a quadratic function based off of the inital data points in (FILE FROM TRANSIT_TIME.PY)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dPdE</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">T0</span></div>

    
<div class="viewcode-block" id="QuadraticModelEphemeris.fit_model">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.QuadraticModelEphemeris.fit_model">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compares the model ephemieris data to the  fit created by the inital data and creates a curve fit which minimizes the difference between the two data sets. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            x : list</span>
<span class="sd">                The list of epochs, normalized to start at 0 (Question for Malia: has this been normalized to 0 yet? - again, it think it has)</span>
<span class="sd">            y : ??</span>
<span class="sd">                The mid-transit times of a given epoch</span>
<span class="sd">            yerr : ??</span>
<span class="sd">                The error in the mid-transit time</span>
<span class="sd">            **kwargs : ??</span>
<span class="sd">                define this</span>

<span class="sd">        Returns</span>
<span class="sd">        ------- </span>
<span class="sd">        Return data : dictionary</span>
<span class="sd">            contains the period, conjunction time, and period change by epoch values and errors, which is used to build a best fit quadratic regression for the model ephemeris data. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_fit</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">unc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>
        <span class="n">return_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;conjunction_time&#39;</span><span class="p">:</span> <span class="n">popt</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="s1">&#39;conjunction_time_err&#39;</span><span class="p">:</span> <span class="n">unc</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">popt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;period_err&#39;</span><span class="p">:</span> <span class="n">unc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;period_change_by_epoch&#39;</span><span class="p">:</span> <span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;period_change_by_epoch_err&#39;</span><span class="p">:</span> <span class="n">unc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">}</span>
        <span class="k">return</span><span class="p">(</span><span class="n">return_data</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CustomModelEphemeris">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.CustomModelEphemeris">[docs]</a>
<span class="k">class</span> <span class="nc">CustomModelEphemeris</span><span class="p">(</span><span class="n">BaseModelEphemeris</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    yet to be buit. Eventually the program will be modified to accept more user input and create custom for the regression model.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="CustomModelEphemeris.fit_model">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.CustomModelEphemeris.fit_model">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span></div>
</div>



<div class="viewcode-block" id="ModelEphemerisFactory">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.ModelEphemerisFactory">[docs]</a>
<span class="k">class</span> <span class="nc">ModelEphemerisFactory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Selects which type of SciPy model (linear, quadratic, or custom) will be used to model the given ephmeris data.</span>

<span class="sd">    STEP 1: checks the user input model_type, then calls the appropriate LinearModelEphemeris(), QuadraticModelEphemeris(), or CustomModelEphemeris(). </span>

<span class="sd">    Returns</span>
<span class="sd">    ------- </span>
<span class="sd">        model : dictonary</span>
<span class="sd">            the returned data dictionary from whichever regression type (linear, quadratic, or custom) was called.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------ </span>
<span class="sd">        error if model specified is not &#39;linear&#39;, &#39;quadratic&#39;, or &#39;custom&#39;.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="ModelEphemerisFactory.create_model">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.ModelEphemerisFactory.create_model">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="n">model_type</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Matches the user input model_type to the correct class of model ephemeris. Calls whichever class of model is desired, then returns the best fit model to the user. </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ADD THIS</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ADD THIS</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ADD THIS</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;linear&#39;</span><span class="p">:</span> <span class="n">LinearModelEphemeris</span><span class="p">(),</span>
            <span class="s1">&#39;quadratic&#39;</span><span class="p">:</span> <span class="n">QuadraticModelEphemeris</span><span class="p">(),</span>
            <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">CustomModelEphemeris</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">model_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid model type: </span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">model_type</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Ephemeris">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris">[docs]</a>
<span class="k">class</span> <span class="nc">Ephemeris</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;BIG DEFINITION </span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    transit_times : obj</span>
<span class="sd">        user generated object from transit_times.py</span>
<span class="sd">    model_type : str </span>
<span class="sd">        Specifies linear or quadratic model of transit time</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    model_ephemeris : list </span>
<span class="sd">        Model of epemieris as a list of dictionaries</span>
<span class="sd">        </span>
<span class="sd">    Exceptions</span>
<span class="sd">    ----------</span>
<span class="sd">     ValueError</span>
<span class="sd">        raised if transit_times is not an instance of the TransitTimes object</span>
<span class="sd">    ----------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transit_times</span><span class="p">):</span>
        <span class="c1"># initializing the transit times object and model ephermeris object</span>
        <span class="c1"># NOTE: We will have the user create their own transit times obj and send that to the ephemeris obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span> <span class="o">=</span> <span class="n">transit_times</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Check that transit_times is an instance of the TransitTimes object</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="p">,</span> <span class="n">TransitTimes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Variable &#39;transit_times&#39; expected type of object &#39;TransitTimes&#39;.&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_get_transit_times_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Process the transit data so it can be used</span>
        <span class="c1"># NOTE QUESTION: Why do we subtract np.min?</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times</span><span class="p">)</span>
        <span class="n">yerr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times_uncertainties</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span>
    
    <span class="k">def</span> <span class="nf">_get_model_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Step 1: Get data from transit times obj</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transit_times_data</span><span class="p">()</span>
        <span class="c1"># Step 2: Create the model with the given variables &amp; user inputs. </span>
        <span class="c1"># This will return a dictionary with the model parameters as key value pairs.</span>
        <span class="n">model_ephemeris_data</span> <span class="o">=</span> <span class="n">ModelEphemerisFactory</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">model_type</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># Step 3: Return the data dictionary with the model parameters</span>
        <span class="k">return</span> <span class="n">model_ephemeris_data</span>
    
    <span class="k">def</span> <span class="nf">_get_k_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_type</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;quadratic&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only linear and quadratic models are supported at this time.&#39;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_calc_linear_model_uncertainties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_data</span><span class="p">):</span>
        <span class="c1"># σ(t pred, tra) = √σ(T0)^2 + σ(P)^2 * E^2</span>
        <span class="c1"># if I want to return in seconds, multiply conjunction time and period by: days &gt; 24 hours &gt; 60 min &gt; 60 sec ()</span>
        <span class="c1"># c_time = model_data[&#39;conjunction_time_err&#39;] * 24 * 60 * 60</span>
        <span class="c1"># period = model_data[&#39;period_err&#39;] * 24 * 60 * 60</span>
        <span class="c1"># print(&#39;new c time&#39;, c_time, &#39;new period&#39;, period)</span>
        <span class="c1"># return np.sqrt((c_time**2) + ((self.transit_times.epochs**2)*(period**2)))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">model_data</span><span class="p">[</span><span class="s1">&#39;conjunction_time_err&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">model_data</span><span class="p">[</span><span class="s1">&#39;period_err&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    
    <span class="k">def</span> <span class="nf">_calc_quadratic_model_uncertainties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_data</span><span class="p">):</span>
        <span class="c1"># σ(t pred, tra) = √σ(T0)^2 + (σ(P)^2 * E^2) + (1/4 * σ(dP/dE)^2 * E^4)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">model_data</span><span class="p">[</span><span class="s1">&#39;conjunction_time_err&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">model_data</span><span class="p">[</span><span class="s1">&#39;period_err&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">model_data</span><span class="p">[</span><span class="s1">&#39;period_change_by_epoch_err&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    
    <span class="k">def</span> <span class="nf">_calc_linear_ephemeris</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">conjunction_time</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">period</span><span class="o">*</span><span class="n">epochs</span><span class="p">)</span> <span class="o">+</span> <span class="n">conjunction_time</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_calc_quadratic_ephemeris</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">conjunction_time</span><span class="p">,</span> <span class="n">period_change_by_epoch</span><span class="p">):</span>
        <span class="k">return</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="n">period_change_by_epoch</span><span class="o">*</span><span class="p">(</span><span class="n">epochs</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">period</span><span class="o">*</span><span class="n">epochs</span><span class="p">)</span> <span class="o">+</span> <span class="n">conjunction_time</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_calc_chi_squared</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_data</span><span class="p">):</span>
        <span class="c1">#this docstring is in the wrong place - must have been copy pasted wrong. figure this out - 12/4/23 HV</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        docstring here </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            model_type : string</span>
<span class="sd">                Type of ephemeris model (either &#39;linear&#39; or &#39;quadratic&#39;) to build</span>

<span class="sd">        STEP 1: Call get model parameters to create a model ephemeris object. get model parameters returns a data dictionary containing data from transit times (epochs, mid transit times, and error). If an error is not given, we will substitute our own error using an array of 1s in the same shape as the given mid transit itmes.</span>
<span class="sd">            </span>
<span class="sd">        STEP 2: Call calc linear ephemeris or calc quadratic ephemeris depending on the model type. Both models use SciPy curve fit to fit data to either a linear or quadratic curve and then returns the curve. </span>
<span class="sd">                     </span>
<span class="sd">        Returns</span>
<span class="sd">        ------- </span>
<span class="sd">            model_data : dictionary</span>
<span class="sd">                model parameters needed to build the curve fit for the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># STEP 1: Get observed transit times</span>
        <span class="n">observed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times</span>
        <span class="n">uncertainties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times_uncertainties</span>
        <span class="c1"># STEP 2: calculate X2 with observed data and model data</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">observed_data</span> <span class="o">-</span> <span class="n">model_data</span><span class="p">)</span><span class="o">/</span><span class="n">uncertainties</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
<div class="viewcode-block" id="Ephemeris.get_model_ephemeris">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris.get_model_ephemeris">[docs]</a>
    <span class="k">def</span> <span class="nf">get_model_ephemeris</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_type</span><span class="p">):</span>
        <span class="c1"># Returns predicted transit times for given epochs</span>
        <span class="c1"># EXPLANATION:</span>
            <span class="c1"># call _get_model... pass in model type (linear or quadratic) model</span>
            <span class="c1"># Getting data from transit times (epochs, mid transit times, and error) ** If an error is not given, we will substitute our own error using an array of 1s in the same shape as your given mid transit itmes</span>
            <span class="c1"># Creates the model ephemeris with ModelEPhemerisFactory obj, passing in data</span>
            <span class="c1"># Model factory will choose which model object to create based on model_type</span>
            <span class="c1"># Model will use scipy curve fit to fit data to whatever and then return parameters</span>
            <span class="c1"># RETURNS model parameters as a dictionary</span>
            <span class="c1"># NOTE: Are these values returned in days? ex: conjunction time, orbital period, change in orbital period</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model_parameters</span><span class="p">(</span><span class="n">model_type</span><span class="p">)</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;model_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_type</span>
        <span class="c1"># ONce we get parameters back, we call _calc_linear_ephemeris </span>
        <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="c1"># Return dict with parameters and model data</span>
            <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;model_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_linear_ephemeris</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;conjunction_time&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;quadratic&#39;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;model_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_quadratic_ephemeris</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;conjunction_time&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;period_change_by_epoch&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">parameters</span></div>

    
<div class="viewcode-block" id="Ephemeris.get_ephemeris_uncertainties">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris.get_ephemeris_uncertainties">[docs]</a>
    <span class="k">def</span> <span class="nf">get_ephemeris_uncertainties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_data_dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;model_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_linear_model_uncertainties</span><span class="p">(</span><span class="n">model_data_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;model_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;quadratic&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_quadratic_model_uncertainties</span><span class="p">(</span><span class="n">model_data_dict</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Ephemeris.calc_bic">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris.calc_bic">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_bic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_data_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         needs to be built</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Step 1: Get value of k based on model_type (linear=2, quad=3, custom=?)</span>
        <span class="n">num_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_k_value</span><span class="p">(</span><span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;model_type&#39;</span><span class="p">])</span>
        <span class="c1"># Step 2: Calculate chi-squared</span>
        <span class="n">chi_squared</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_chi_squared</span><span class="p">(</span><span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;model_data&#39;</span><span class="p">])</span>
        <span class="c1"># print(&#39;chi squared&#39;, chi_squared)</span>
        <span class="c1"># Step 3: Calculate BIC</span>
        <span class="k">return</span> <span class="n">chi_squared</span> <span class="o">+</span> <span class="p">(</span><span class="n">num_params</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;model_data&#39;</span><span class="p">])))</span></div>


<div class="viewcode-block" id="Ephemeris.calc_delta_bic">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris.calc_delta_bic">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_delta_bic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         needs to be built</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">linear_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_ephemeris</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
        <span class="n">quadratic_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_ephemeris</span><span class="p">(</span><span class="s1">&#39;quadratic&#39;</span><span class="p">)</span>
        <span class="n">linear_bic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bic</span><span class="p">(</span><span class="n">linear_data</span><span class="p">)</span>
        <span class="n">quadratic_bic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bic</span><span class="p">(</span><span class="n">quadratic_data</span><span class="p">)</span>
        <span class="n">delta_bic</span> <span class="o">=</span> <span class="n">linear_bic</span> <span class="o">-</span> <span class="n">quadratic_bic</span>
        <span class="k">return</span> <span class="n">delta_bic</span></div>

    
<div class="viewcode-block" id="Ephemeris.plot_model_ephemeris">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris.plot_model_ephemeris">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_model_ephemeris</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_data_dict</span><span class="p">,</span> <span class="n">save_plot</span><span class="p">,</span> <span class="n">save_filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;model_data&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epochs&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Model Predicted Mid-Transit Times&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Predicted Model Mid Transit Times over Epochs&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_plot</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_filepath</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Ephemeris.plot_timing_uncertainties">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris.plot_timing_uncertainties">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_timing_uncertainties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_data_dict</span><span class="p">,</span> <span class="n">save_plot</span><span class="p">,</span> <span class="n">save_filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># get uncertainties</span>
        <span class="n">model_uncertainties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ephemeris_uncertainties</span><span class="p">(</span><span class="n">model_data_dict</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span>
        <span class="c1"># get T(E) - T0 - PE</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;model_data&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;conjunction_time&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">model_data_dict</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">))</span>
        <span class="c1"># plot the y line, then the line +- the uncertainties</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$t(E) - T_</span><span class="si">{0}</span><span class="s1"> - PE$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">model_uncertainties</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$(t(E) - T_</span><span class="si">{0}</span><span class="s1"> - PE) + σ_{t^</span><span class="si">{pred}</span><span class="s1">_</span><span class="si">{tra}</span><span class="s1">}$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">model_uncertainties</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$(t(E) - T_</span><span class="si">{0}</span><span class="s1"> - PE) - σ_{t^</span><span class="si">{pred}</span><span class="s1">_</span><span class="si">{tra}</span><span class="s1">}$&#39;</span><span class="p">)</span>
        <span class="c1"># Add labels and show legend</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epochs&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Days&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save_plot</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_filepath</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Ephemeris.plot_oc_plot">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris.plot_oc_plot">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_oc_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_plot</span><span class="p">,</span> <span class="n">save_filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># y = T0 - PE - 0.5 dP/dE E^2</span>
        <span class="n">lin_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_ephemeris</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
        <span class="n">quad_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_ephemeris</span><span class="p">(</span><span class="s1">&#39;quadratic&#39;</span><span class="p">)</span>
        <span class="n">lin_bic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bic</span><span class="p">(</span><span class="n">lin_model</span><span class="p">)</span>
        <span class="n">quad_bic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bic</span><span class="p">(</span><span class="n">quad_model</span><span class="p">)</span>

        <span class="n">days_to_seconds</span> <span class="o">=</span> <span class="mi">86400</span>
        <span class="c1"># y = self.transit_times.mid_transit_times - Yees_period*self.transit_times.epochs -0.5*Yees_dPdE/days_to_seconds*(self.transit_times.epochs - np.median(self.transit_times.epochs))**2</span>
        <span class="c1"># plot points w/ x=epoch, y=T0-PE, yerr=sigmaT0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times</span> <span class="o">-</span> <span class="n">lin_model</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">)</span><span class="o">*</span><span class="n">days_to_seconds</span><span class="p">,</span> 
                    <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times_uncertainties</span><span class="o">*</span><span class="n">days_to_seconds</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\left(t(E) - T_0 - P E\right)$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">quad_model</span><span class="p">[</span><span class="s1">&#39;period_change_by_epoch&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">days_to_seconds</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">days_to_seconds</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;quad BIC = </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">quad_bic</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="p">(</span><span class="n">lin_model</span><span class="p">[</span><span class="s1">&#39;model_data&#39;</span><span class="p">])</span><span class="o">*</span><span class="n">days_to_seconds</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;linear BIC = </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">lin_bic</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;O-C (seconds)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_plot</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_filepath</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Ephemeris.plot_running_delta_bic">
<a class="viewcode-back" href="../../ephemeris.html#susie.ephemeris.Ephemeris.plot_running_delta_bic">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_running_delta_bic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_plot</span><span class="p">,</span> <span class="n">save_filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">delta_bics</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span>
        <span class="n">all_mid_transit_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times</span>
        <span class="n">all_uncertainties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times_uncertainties</span>
        <span class="c1"># for each epoch (starting at 3?), calculate the delta bic, plot delta bics over epoch</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_epochs</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">delta_bics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times</span> <span class="o">=</span> <span class="n">all_mid_transit_times</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">mid_transit_times_uncertainties</span> <span class="o">=</span> <span class="n">all_uncertainties</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="n">all_epochs</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">delta_bic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_delta_bic</span><span class="p">()</span>
                <span class="n">delta_bics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta_bic</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">delta_bics</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_times</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="n">delta_bics</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_plot</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_filepath</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>


<span class="c1"># if __name__ == &#39;__main__&#39;:</span>
<span class="c1">#     # STEP 1: Upload data from file</span>
<span class="c1">#     filepath = &quot;../../malia_examples/WASP12b_transit_ephemeris.csv&quot;</span>
<span class="c1">#     data = np.genfromtxt(filepath, delimiter=&#39;,&#39;, names=True)</span>
<span class="c1">#     # STEP 2: Break data up into epochs, mid transit times, and error</span>
<span class="c1">#     epochs = data[&quot;epoch&quot;] - np.min(data[&quot;epoch&quot;])</span>
<span class="c1">#     mid_transit_times = data[&quot;transit_time&quot;] - np.min(data[&quot;transit_time&quot;])</span>
<span class="c1">#     mid_transit_times_err = data[&quot;sigma_transit_time&quot;]</span>
<span class="c1">#     # STEP 2.5 (Optional): Make sure the epochs are integers and not floats</span>
<span class="c1">#     epochs = epochs.astype(&#39;int&#39;)</span>
<span class="c1">#     # STEP 3: Create new transit times object with above data</span>
<span class="c1">#     # transit_times_obj1 = TransitTimes(&#39;jd&#39;, epochs, mid_transit_times, mid_transit_times_err, object_ra=97.64, object_dec=29.67, observatory_lat=43.60, observatory_lon=-116.21)</span>
<span class="c1">#     # print(vars(transit_times_obj1))</span>
<span class="c1">#     transit_times_obj1 = TransitTimes(&#39;jd&#39;, epochs, mid_transit_times, mid_transit_times_err, time_scale=&#39;tdb&#39;)</span>
<span class="c1">#     # STEP 4: Create new ephemeris object with transit times object</span>
<span class="c1">#     ephemeris_obj1 = Ephemeris(transit_times_obj1)</span>
<span class="c1">#     # STEP 5: Get model ephemeris data</span>
<span class="c1">#     model_data = ephemeris_obj1.get_model_ephemeris(&#39;quadratic&#39;)</span>
<span class="c1">#     print(model_data)</span>
<span class="c1">#     # STEP 6: Show a plot of the model ephemeris data</span>
<span class="c1">#     ephemeris_obj1.plot_model_ephemeris(model_data, save_plot=False)</span>
<span class="c1">#     # STEP 7: Uncertainties plot</span>
<span class="c1">#     ephemeris_obj1.plot_timing_uncertainties(model_data, save_plot=False)</span>
<span class="c1">#     bic = ephemeris_obj1.calc_bic(model_data)</span>
<span class="c1">#     print(bic)</span>

<span class="c1">#     print(ephemeris_obj1.calc_delta_bic())</span>
<span class="c1">#     print(ephemeris_obj1.plot_running_delta_bic(save_plot=False))</span>
<span class="c1">#     ephemeris_obj1.plot_running_delta_bic(save_plot=False)</span>

<span class="c1">#     ephemeris_obj1.plot_oc_plot(False)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Holly VanLooy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>